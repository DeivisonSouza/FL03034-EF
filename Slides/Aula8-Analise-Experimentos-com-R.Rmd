---
title: "Experimentação Florestal (FL03034 - EF)"
subtitle: "Análise de Experimentos com Linguagem R"
author: "Prof. Dr. Deivison Venicio Souza"
institute: "Universidade Federal do Pará (UFPA)"
date: 
encoding: "UTF-8"
header-includes: 
   - \usepackage{xcolor}
   - \usepackage{amsmath}
output:
  xaringan::moon_reader:
    css:
      - default
      - assets/sydney-fonts.css
      - assets/slide-title/sydney-title.css
    self_contained: false
    seal: false
    includes:
      in_header: "assets/mathjax-equation-numbers.html"
    nature:
      beforeInit: ["assets/remark-zoom.js", "https://platform.twitter.com/widgets.js"]
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      highlightLanguage: ["r", "css", "yaml"]
      ratio: '16:9'
      navigation:
        scroll: false
---
class: title-slide, center, middle
background-image: url(fig/slide-title/ufpa2.png), url(fig/slide-title/forest.png), url(fig/slide-title/img3.png)
background-position: 84% 90%, 95% 90%
background-size: 220px, 90px, cover

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	error = FALSE,
	fig.align = "center",
	fig.showtext = TRUE,
	message = FALSE,
	warning = FALSE,
	cache = FALSE,
	collapse = TRUE,
	dpi = 600
)
```

```{r packages, include=FALSE}
# remotes::install_github("dill/emoGG")
library(ggplot2)
library(dplyr)
library(ggimage)
library(kableExtra)
library(readr)
```

```{r xaringan-logo, echo=FALSE}
library(xaringanExtra)
use_logo(
  image_url = "fig/slide-title/ufpa.png",
  position = css_position(top = ".8em", right = "-.5em"),
  width = "140px",
  height = "140px"
)

use_extra_styles(
  hover_code_line = TRUE,         #<<
  mute_unhighlighted_code = TRUE  #<<
)
xaringanExtra::use_editable(expires = 1)
#.can-edit[Você pode editar este título de slide]
#.can-edit.key-firstSlideTitle[Change this title and then reload the page]
use_clipboard()
```

```{r, load_refs, include=FALSE, cache=FALSE}
library(RefManageR)
BibOptions(check.entries = FALSE,
           bib.style = "authoryear",
           cite.style = "authoryear",
           style = "html",
           hyperlink = FALSE,
           dashed = FALSE)
(myBib <- ReadBib("./bib/ref.bib", check = FALSE))
```

```{r icon, echo=FALSE}
#remotes::install_github("mitchelloharawild/icons")
#remotes::install_github('emitanaka/anicon')
#library(icons)
#download_fontawesome()
#download_simple_icons()
```

```{r customDT, echo=F}
CustomDT <- function(data){
  data %>% DT::datatable(editable = 'cell', rownames = FALSE,
                         style = "default",
                         class = "display", width = '250px',
                         caption = '',
     options=list(pageLength = 8, dom = 'tip', autoWidth = F,
       initComplete = htmlwidgets::JS(
          "function(settings, json) {",
          paste0("$(this.api().table().container()).css({'font-size': '", "9pt", "'});"),
          "}")
       ) 
     )
}
```

```{r customDT2, echo=F}
CustomDT2 <- function(data){
  data %>% DT::datatable(editable = 'cell', rownames = FALSE,
                         style = "default",
                         class = "compact", width = '500px',
                         caption = '',
     options=list(pageLength = 25, dom = 't', autoWidth = F,
                  columnDefs = list(list(className = 'dt-center', targets = "_all")),
       initComplete = htmlwidgets::JS(
          "function(settings, json) {",
          paste0("$(this.api().table().container()).css({'font-size': '", "8pt", "'});"),
          "}")
       ) 
     )
}
```

```{r customkbl, echo=F}
Customkbl <- function(data){
  data %>%
    kbl() %>%
    kable_classic(full_width = F, html_font = "Cambria") %>% 
  kable_paper(bootstrap_options = "striped", full_width = F) %>% 
  kable_styling(bootstrap_options = "striped", font_size = 18, position = "center") %>% 
  row_spec(1:4, color = 'black', background = 'white') %>% 
  row_spec(0, color = 'white', background = 'black') %>% 
  column_spec(1, color = 'white', background = 'black')
}
```


<!-- title-slide -->
# Experimentação Florestal <br> (FL03034 - EF)
<br>
## `r anicon::faa("pagelines", animate="horizontal", colour="green")` Análise de Experimentos `r anicon::faa("pagelines", animate="horizontal", colour="green")` <br> com Linguagem R

##### .font120[**Prof. Dr. Deivison Venicio Souza**]
##### Universidade Federal do Pará (UFPA)
##### Faculdade de Engenharia Florestal
##### E-mail: deivisonvs@ufpa.br
<br>
##### 1ª versão: 25/março/2022 <br> (Atualizado em: `r format(Sys.Date(),"%d/%B/%Y")`) <br> Altamira, Pará

---
layout: true
<div class="my-header"></div>
<div class="my-footer"><span>Prof. Dr. Deivison Venicio Souza (E-mail: deivisonvs@ufpa.br)&emsp;&emsp;&emsp;&emsp;&emsp;Experimentação Florestal (FL03034 - EF) - Análise de Experimentos com Linguagem R</div>

---

## Ementa da disciplina (FL03034 - EF)

.shadow3[
<br>
1 - Introdução à experimentação; 

2 - Análise exploratória de dados;

3 - Delineamento inteiramente casualizado - DIC;

4 - Delineamento em blocos ao acaso - DBC;

5 - Delineamento em quadrado latino - DQL;

6 - Testes de comparação de médias; 

7 - Experimentos em esquema fatorial;

8 - Análise de correlação e regressão linear; e

**9 - Análise de experimentos com linguagem R**.

]

---

## Objetivos
<br><br>
Ao final desta aula espera-se que o discente seja capaz de...

* Conhecer alguns dos principais pacotes disponíveis na linguagem R para análise de dados experimentais;
* Aprender a realizar a Análise de Variância (ANOVA) de dados experimentais e pós-testes de comparações de médias; 
* Aprender a realizar a avaliação de pressupostos da ANOVA; e
* Construir visualizações informativas dos resultados da análise estatística dos experimentos.

---

## Conteúdo

.pull-left-4[
.font90[
**Parte 1 - Alguns pacotes especializados disponíveis no R**

[1 - Pacote agricolae](#agri)

[2 - Pacote ExpDes.pt](#expdes)

[3 - Pacote AgroR](#agror)

]
]

.pull-right-4[
.pull-down[
.font90[
**Parte 2 - Estudos de casos de experimentos**

[1 - Diferentes tipos de substratos <br> (comprimento da raíz e parte aérea) - Experimento em DIC](#dic)

]
]
]

---

layout: false
name: conc
class: inverse, top, left
background-image: url(fig/class8/secao.png)
background-size: cover

<br><br><br>

.right[.font130[**.green[Parte 1] <br> Estudos de casos <br> de experimentos**]]

<br><br>

.center[.font130[**1 - Diferentes tipos de substratos (DIC)** <br> (comprimento da raíz e parte aérea)]]

---
layout: true
<div class="my-header"></div>
<div class="my-footer"><span>Prof. Dr. Deivison Venicio Souza (E-mail: deivisonvs@ufpa.br)&emsp;&emsp;&emsp;&emsp;&emsp;Experimentação Florestal (FL03034 - EF) - Análise de Experimentos com Linguagem R</div>

---
name: anvdic
## Análise de Experimentos em DIC com R
<br>

### .font90[Dados fictícios - Diferentes tipos de substratos (comprimento da raíz e parte aérea)]
<br>

.font90[
.center[**Sobre o experimento...**]
Um experimento foi conduzido sob o delineamento inteiramente casualizado (DIC), com 5 repetições, com o objetivo de avaliar o Crescimento em Raíz (CR) e Crescimento da Parte Aérea (CPA) de *Swietenia macrophylla* (Mogno brasileiro) submetido à diferentes tipos de substratos: `Fibra de Coco (FC)`; `Areia + Esterco Bovino (A+EB)`; `Casca de Arroz + Terra Subsolo (CA + TS)`; `Substrato Comercial (SC)` e `Terra Preta (TP)`. Os dados apresentados na tabela a seguir referem-se aos valores médios das variáveis, em centímetros, nas parcelas experimentais.
<br>

]

---

## Análise de Experimentos em DIC com R

.left-column[
```{r , echo=FALSE, eval=TRUE}
data <- readr::read_csv("data/DIC_Ficticio2.csv")

data %>% CustomDT2
```
]

.right-column[
### Algum substrato possui média significativamente superior? 

* Avalie as duas variáveis respostas: `Crescimento de Raíz (CR)` e `Crescimento da Parte Aérea (CPA)`...
]

---

## Análise de Experimentos em DIC com R

- **Vamos analisar esses dados experimentais...**

.shadow1a[
## .font70[**Siga a seguinte sequência de análise...**]
<br>
.font90[
1) Carregue o conjunto de dados e analise a estrutura dos dados. (Obs.: Use a função `str()`. As variáveis categoricas são da classe *factor*?)

2) Realize uma análise exploratória dos dados experimentais (quantitativa e visual).

3) Realize a ANOVA do experimento em DIC e interprete o Teste F-Snedecor (experimente $\alpha$ = 0,01 e 0,05).

4) Realize a análise de pressupostos da ANOVA (faça os testes de hipóteses.)

5) Se os pressupostos da ANOVA são atendidos, realize testes de comparações múltiplas de médias paramétricos (Tukey e Duncan).
<br><br>

Obs.: Experimente os 3 pacotes (**agricolae**, **ExpDest.pt**, **AgroR**)
]
]

---

## Análise de Experimentos em DIC com R
<br>

**.blue[1) Carregue o conjunto de dados e análise da estrutura dos dados.]**

.pull-left-10[
- **Passo 1** - Carregar o conjunto de dados...

`r anicon::faa("hand-point-right", animate="horizontal")` **Use**: a função .orange[**read_csv()**] do pacote **readr** para carregar os dados...

<br><br>

.font90[**Importante**: para aplicar as funções do R-base ou funções de outros pacotes, os dados precisam estar empilhados. (formato longo)]

]

--

.pull-right-10[
.font90[
```{r read, echo=T, eval=F}
library(readr)
(data <- 
    read_csv("data/DIC_Ficticio2.csv", 
             col_types = "ffdd"))
```

```{r ref.label="read", echo=F, eval=T, collapse=T}
```
]
]
---

## Análise de Experimentos em DIC com R
<br>

**.blue[1) Carregue o conjunto de dados e análise da estrutura dos dados]**

.pull-left-4[
```{r est, echo=T, eval=F}
# Estrutura dos dados
str(data)
```

```{r ref.label="est", echo=F, eval=T, collapse=T}
```

]

.pull-right-4[
```{r xtab, echo=T, eval=F}
# Tabela de frequência por tratamento
xtabs(~Sub + Rep, data = data)
```

```{r ref.label="xtab", echo=F, eval=T, collapse=T}
```
]

---

## Análise de Experimentos em DIC com R
<br>

**.blue[2) Realizar uma análise exploratória dos dados experimentais (quantitativa e visual).]**
<br><br>

.pull-top[
.font90[
- **Passo 2** - Obter um resumo estatístico por tratamento (Substrato)...
  - A linguagem R possui diversos pacotes para gerar resumos estatísticos;
  - Usaremos a função .orange[**stby()**] do pacote **summarytools** para obter estatísticas descritivas;
  - Usaremos o pacote **ggplot2** para fazer gráficos elegantes e o **plotly** para cria gráficos interativos; e
  - Experimente também as funções dos pacotes: **Hmisc**, **pastecs**, **psych** e **skimr**.
]
]

---

## Análise de Experimentos em DIC com R
<br>

**.blue[2) Realizar uma análise exploratória dos dados experimentais (quantitativa e visual).]**

.pull-left-4[
.font80[
- **Passo 2** - Obter um resumo estatístico por tratamento (Substrato) para cada variável (CR e CPA)...
]

```{r tools, echo=T, eval=F}
library(summarytools)
stby(data    = data,
     INDICES = data$Sub, 
     FUN     = descr,
     stats   = c("mean", "sd", "min", "max")) %>% 
  tb(order = 2)
```

.font70[
**Tutorial**: https://cran.r-project.org/web/packages/summarytools/vignettes/introduction.html
]

]

--

.pull-right-4[
```{r ref.label="tools", echo=F, eval=T, collapse=T}
```
]

---

## Análise de Experimentos em DIC com R

**.blue[2) Realizar uma análise exploratória dos dados experimentais (quantitativa e visual).]**

.pull-left-4[
.font80[
- **Passo 2** - Obter um resumo estatístico por tratamento (Substrato) para cada variável (CR e CPA)...(BoxPlot por Substrato)

```{r box, echo=TRUE, eval=FALSE}
# Criando um BoxPlot Por Substrato
g1 <- data %>% 
  ggplot(aes(x = reorder(Sub, -CR), y = CR)) + 
  geom_boxplot(mapping = aes(fill = Sub)) + 
  stat_summary(fun = mean, 
               geom = "point", 
               shape = 20, 
               size = 1.5,
               color = "red"
               ) +
  theme(legend.position="none") +
  scale_y_continuous(name = "Comprimento da Raiz (cm)", 
                     breaks = seq(2, 11, 2),
                     limits = c(2, 11)) +
  labs(x = "Substrato")

plotly::ggplotly(g1)

```
]
]

.pull-right-4[
```{r ref.label="box", echo=FALSE, eval=TRUE, collapse=T, fig.width=.9, fig.height=.7, fig.align='center', fig.cap='', dpi=600}
```
]

---

## Análise de Experimentos em DIC com R

**.blue[2) Realizar uma análise exploratória dos dados experimentais (quantitativa e visual).]**

.pull-left-4[
.font80[
- **Passo 2** - Obter um resumo estatístico por tratamento (Substrato) para cada variável (CR e CPA)...(BoxPlot por Substrato)

```{r box2, echo=TRUE, eval=FALSE}
# Criando um BoxPlot Por Substrato
g2 <- data %>% 
  ggplot(aes(x = reorder(Sub, -CPA), y = CPA)) + 
  geom_boxplot(mapping = aes(fill = Sub)) + 
  stat_summary(fun = mean, 
               geom = "point", 
               shape = 20, 
               size = 1.5,
               color = "red"
               ) +
  theme(legend.position="none") +
  scale_y_continuous(
    name = "Comprimento da Parte Aérea (cm)",
    breaks = seq(22, 29, 2),
    limits = c(22, 29)) +
  labs(x = "Substrato")

plotly::ggplotly(g2)

```
]
]

.pull-right-4[
```{r ref.label="box2", echo=FALSE, eval=TRUE, collapse=T, fig.width=.9, fig.height=.7, fig.align='center', fig.cap='', dpi=600}
```
]

---

## Análise de Experimentos em DIC com R

**.blue[2) Realizar uma análise exploratória dos dados experimentais (quantitativa e visual).]**

.pull-left-4[
.font80[
- **Passo 2** - Obter um resumo estatístico por tratamento (Substrato) para cada variável (CR e CPA)...(Gráfico de barra por Substrato)

```{r bar, echo=T, eval=F}
data |>
  ggplot(
    mapping = aes(x = Sub, 
                  y = CR)) +
  geom_bar(
    mapping = aes(fill = Sub),
    stat = "summary",
    fun = mean
    ) +
  geom_errorbar(stat = "summary", 
                fun.ymin = function(x) {mean(x)-sd(x)},
                fun.ymax = function(x) {mean(x)+sd(x)},
                width = .2
                ) +
  theme(legend.position="none") +
  scale_y_continuous(name = "Comprimento da Raiz (cm)", 
                     breaks = seq(0, 11, 2),
                     limits = c(0, 11)) +
  labs(x = "Substrato")
```
]
]

--

.pull-right-4[
<br><br>
```{r ref.label="bar", echo=FALSE, eval=TRUE, collapse=T, fig.width=5, fig.height=3.5, fig.align='center', fig.cap='', dpi=600}
```
]

---

## Análise de Experimentos em DIC com R

**.blue[2) Realizar uma análise exploratória dos dados experimentais (quantitativa e visual).]**

.pull-left-4[
.font80[
- **Passo 2** - Obter um resumo estatístico por tratamento (Substrato) para cada variável (CR e CPA)...(Gráfico de barra por Substrato)

```{r bar2, echo=T, eval=F}
data |>
  ggplot(
    mapping = aes(x = Sub, 
                  y = CPA)) +
  geom_bar(
    mapping = aes(fill = Sub),
    stat = "summary",
    fun = mean
    ) +
  geom_errorbar(stat = "summary", 
                fun.ymin = function(x) {mean(x)-sd(x)},
                fun.ymax = function(x) {mean(x)+sd(x)},
                width = .2
                ) +
  theme(legend.position="none") +
  scale_y_continuous(name = "Comprimento da Parte Aérea (cm)", 
                     breaks = seq(0, 29, 2),
                     limits = c(0, 29)) +
  labs(x = "Substrato")
```
]
]

--

.pull-right-4[
<br><br>
```{r ref.label="bar2", echo=FALSE, eval=TRUE, collapse=T, fig.width=5, fig.height=3.5, fig.align='center', fig.cap='', dpi=600}
```
]

---

## Análise de Experimentos em DIC com R
<br>

**.blue[2) Realizar uma análise exploratória dos dados experimentais (quantitativa e visual).]**

.pull-left-4[
.font80[
- **Passo 2** - Obter um resumo estatístico por tratamento (Substrato)...

```{r xplot, echo=T, eval=F}

library(lattice)

xyplot(CR ~ reorder(Sub, -CR),
       data = data,
       type = c("p", "a"),
       ylab = expression("Diâmetro (cm)"),
       xlab = expression("Substrato"))
```
]
]

--

.pull-right-4[
<br><br>
```{r ref.label="xplot", echo=FALSE, eval=TRUE, collapse=T, fig.width=5, fig.height=3.5, fig.align='center', fig.cap='', dpi=600}
```
]

---

## Análise de Experimentos em DIC com R
<br>

**.blue[3) Realizar a ANOVA do experimento em DIC e interpretar o Teste F-Snedecor <br> (experimente α = 0,01 e 0,05).]**






---

## Referências
<br><br>
DIAS, L. A. dos S.; BARROS, W. S. Biometria experimental. Viçosa, MG: Suprema, 2009. 408 p.
<br><br>
NOGUEIRA, M. C. S. Experimentação agronômica I: conceitos, planejamento e análise estatística. Piracicaba, 479 p. 2007.
<br><br>
PIMENTEL-GOMES, F.; GARCIA, C. H. Estatística aplicada a experimentos agronômicos e florestais: exposição com exemplos e orientações para uso de aplicativos. Piracicaba: FEALQ, 2002. 309 p.

<!--Slide XX -->
---
layout: false
class: inverse, top, right
background-image: url(fig/class1/imgC.jpg)
background-size: cover

.font300[
Obrigado!
]
<br><br><br><br><br><br>

**Email**: <a href="mailto:deivisonvs@ufpa.br">deivisonvs@ufpa.br</a>

**Github**: <a href="https://github.com/DeivisonSouza">@DeivisonSouza</a>

